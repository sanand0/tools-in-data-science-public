{{/* Prev/next override driven by sidebar order.
      Order source: `data/sidebar-nav.yaml` generated by setup.sh from _sidebar.md files.
      Goal: footer navigation should mirror sidebar sequence exactly. */}}
{{ $path := .RelPermalink }}
{{ $nav := index .Site.Data "sidebar-nav" }}

{{ $activeKey := "root" }}
{{ if or (eq $path "/2025-01/") (hasPrefix $path "/2025-01/") }}
  {{ $activeKey = "2025-01" }}
{{ else if or (eq $path "/2025-05/") (hasPrefix $path "/2025-05/") }}
  {{ $activeKey = "2025-05" }}
{{ else if or (eq $path "/2025-09/") (hasPrefix $path "/2025-09/") }}
  {{ $activeKey = "2025-09" }}
{{ else if in (default (slice) (index $nav "2025-09")) $path }}
  {{ $activeKey = "2025-09" }}
{{ else if in (default (slice) (index $nav "2025-05")) $path }}
  {{ $activeKey = "2025-05" }}
{{ else if in (default (slice) (index $nav "2025-01")) $path }}
  {{ $activeKey = "2025-01" }}
{{ end }}

{{ $order := default (slice) (index $nav $activeKey) }}
{{ $ix := -1 }}
{{ range $i, $p := $order }}
  {{ if eq $p $path }}
    {{ $ix = $i }}
  {{ end }}
{{ end }}

{{ if ge $ix 0 }}
  {{ $prevPath := "" }}
  {{ $nextPath := "" }}
  {{ if gt $ix 0 }}
    {{ $prevPath = index $order (sub $ix 1) }}
  {{ end }}
  {{ if lt (add $ix 1) (len $order) }}
    {{ $nextPath = index $order (add $ix 1) }}
  {{ end }}

  {{ $prevPage := cond (ne $prevPath "") (.Site.GetPage $prevPath) nil }}
  {{ $nextPage := cond (ne $nextPath "") (.Site.GetPage $nextPath) nil }}
  {{ if or $prevPage $nextPage }}
  <div class="flex flex-wrap justify-between">
    <span>
    {{ with $prevPage }}
      <a href="{{ .RelPermalink }}" class="flex align-center">
        <img src="{{ partial "docs/icon" "backward" }}" class="book-icon" alt="{{ partial "docs/text/i18n" "Backward" }}" />
        <span>{{ partial "docs/title" . }}</span>
      </a>
    {{ end }}
    </span>
    <span>
    {{ with $nextPage }}
      <a href="{{ .RelPermalink }}" class="flex align-center">
        <span>{{ partial "docs/title" . }}</span>
        <img src="{{ partial "docs/icon" "forward" }}" class="book-icon" alt="{{ partial "docs/text/i18n" "Forward" }}" />
      </a>
    {{ end }}
    </span>
  </div>
  {{ end }}
{{ end }}
